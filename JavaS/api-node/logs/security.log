[2025-10-01T02:56:15.020Z] SECURITY_EVENT | TYPE: FAILED_AUTH | IP: ::1 | ROUTE: /api/admin/dashboard | USER: admin | REASON: INVALID_CREDENTIALS
[2025-10-01T02:56:20.844Z] SECURITY_EVENT | TYPE: FAILED_AUTH | IP: ::1 | ROUTE: /api/admin/dashboard | USER: UNKNOWN | REASON: NO_AUTH_HEADER
[2025-10-01T02:56:26.377Z] SECURITY_EVENT | TYPE: FAILED_AUTH | IP: ::1 | ROUTE: /api/jwt/protected | USER: UNKNOWN | REASON: MALFORMED_TOKEN
[2025-10-01T02:56:53.779Z] SECURITY_EVENT | TYPE: SUCCESSFUL_AUTH | IP: ::1 | ROUTE: /api/admin/dashboard | MESSAGE: Autenticación básica exitosa para usuario: admin | DATA: {"authType":"BASIC_AUTH","username":"admin"}
[2025-10-01T23:48:19.796Z] SECURITY_EVENT | TYPE: USER_DELETED | IP: ::1 | ROUTE: /api/usuarios/6 | MESSAGE: Usuario eliminado: KEVIN HUITRON (khuitron777@gmail.com) | DATA: {"deletedUserId":"6","userName":"KEVIN HUITRON","userEmail":"khuitron777@gmail.com"}
[2025-10-02T00:06:30.072Z] SECURITY_EVENT | TYPE: USER_DELETED | IP: ::1 | ROUTE: /api/usuarios/13 | MESSAGE: Usuario eliminado: Ana García (ana.garcia@ejemplo.com) | DATA: {"deletedUserId":"13","userName":"Ana García","userEmail":"ana.garcia@ejemplo.com"}
[2025-10-02T00:54:36.810Z] SECURITY_EVENT | TYPE: UNCAUGHT_EXCEPTION | IP: SERVER | ROUTE: GLOBAL | MESSAGE: Error no capturado en el servidor | DATA: {"error":"Cannot access 'validateRequiredFields' before initialization","stack":"ReferenceError: Cannot access 'validateRequiredFields' before initialization\n    at Object.<anonymous> (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\app.js:1013:3)\n    at Module._compile (node:internal/modules/cjs/loader:1706:14)\n    at Object..js (node:internal/modules/cjs/loader:1839:10)\n    at Module.load (node:internal/modules/cjs/loader:1441:32)\n    at Function._load (node:internal/modules/cjs/loader:1263:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:171:5)\n    at node:internal/main/run_main_module:36:49","timestamp":"2025-10-02T00:54:36.803Z"}
[2025-10-02T00:58:38.227Z] SECURITY_EVENT | TYPE: UNCAUGHT_EXCEPTION | IP: SERVER | ROUTE: GLOBAL | MESSAGE: Error no capturado en el servidor | DATA: {"error":"Cannot access 'validateRequiredFields' before initialization","stack":"ReferenceError: Cannot access 'validateRequiredFields' before initialization\n    at Object.<anonymous> (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\app.js:1013:3)\n    at Module._compile (node:internal/modules/cjs/loader:1706:14)\n    at Object..js (node:internal/modules/cjs/loader:1839:10)\n    at Module.load (node:internal/modules/cjs/loader:1441:32)\n    at Function._load (node:internal/modules/cjs/loader:1263:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:237:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:171:5)\n    at node:internal/main/run_main_module:36:49","timestamp":"2025-10-02T00:58:38.226Z"}
[2025-10-02T01:12:29.904Z] SECURITY_EVENT | TYPE: EXPRESS_ERROR | IP: ::1 | ROUTE: /api/logs/http-stats | MESSAGE: Error en middleware de Express | DATA: {"error":"Cannot read properties of undefined (reading 'length')","method":"GET","url":"/api/logs/http-stats","stack":"TypeError: Cannot read properties of undefined (reading 'length')\n    at httpRequestLogger (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\app.js:2180:42)\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:342:13)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:297:9\n    at processParams (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:582:12)\n    at next (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:291:5)\n    at addCustomHeaders (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\app.js:58:3)\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:342:13)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:297:9"}
[2025-10-10T16:50:15.308Z] SECURITY_EVENT | TYPE: EXPRESS_ERROR | IP: ::1 | ROUTE: /api/historial/comparaciones | MESSAGE: Error en middleware de Express | DATA: {"error":"Unexpected token '<', ...\"erico_1\": <id_perife\"... is not valid JSON","method":"POST","url":"/api/historial/comparaciones","stack":"SyntaxError: Unexpected token '<', ...\"erico_1\": <id_perife\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at parse (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\body-parser\\lib\\types\\json.js:77:19)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\body-parser\\lib\\read.js:123:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\raw-body\\index.js:238:16)\n    at done (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)"}
[2025-10-20T14:18:00.758Z] SECURITY_EVENT | TYPE: DB_CONNECTION_ERROR | IP: SERVER | ROUTE: GLOBAL | MESSAGE: Error conectando a PostgreSQL | DATA: {"error":"la autentificaci�n password fall� para el usuario �arche�"}
[2025-10-20T14:24:18.753Z] SECURITY_EVENT | TYPE: ORDER_CREATION_ERROR | IP: ::1 | ROUTE: /api/orders | MESSAGE: Error crítico creando pedido | DATA: {"error":"Cannot read properties of undefined (reading 'orderService')","stack":"TypeError: Cannot read properties of undefined (reading 'orderService')\n    at createOrder (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\controllers\\orderController.js:52:33)\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:157:13)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\middlewares\\rateLimiter.js:56:5\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:157:13)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\middlewares\\auth.js:79:5\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\jsonwebtoken\\verify.js:261:12\n    at getSecret (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\jsonwebtoken\\verify.js:97:14)\n    at module.exports [as verify] (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\jsonwebtoken\\verify.js:101:10)","body":{"orderData":{"shipping_address":"123 Test Street","user_id":19,"total_amount":299.97,"payment_method":"CREDIT_CARD"},"orderItems":[{"subtotal":129.99,"quantity":1,"product_id":1,"unit_price":129.99},{"subtotal":159.98,"quantity":2,"product_id":2,"unit_price":79.99}]}}
[2025-10-20T14:43:43.662Z] SECURITY_EVENT | TYPE: EXPRESS_ERROR | IP: ::1 | ROUTE: /api/auth/login | MESSAGE: Error en middleware de Express | DATA: {"error":"Cannot read properties of undefined (reading 'email')","method":"POST","url":"/api/auth/login","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\utils\\validators.js:15:20\n    at Array.forEach (<anonymous>)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\utils\\validators.js:14:20\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:295:15\n    at processParams (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:582:12)"}
[2025-10-20T14:47:56.391Z] SECURITY_EVENT | TYPE: EXPRESS_ERROR | IP: ::1 | ROUTE: /api/auth/login | MESSAGE: Error en middleware de Express | DATA: {"error":"Cannot read properties of undefined (reading 'email')","method":"POST","url":"/api/auth/login","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\utils\\validators.js:15:20\n    at Array.forEach (<anonymous>)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\utils\\validators.js:14:20\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\lib\\layer.js:152:17)\n    at D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:295:15\n    at processParams (D:\\Repositorio\\Bdd Compareware\\javas\\api-node\\node_modules\\router\\index.js:582:12)"}
[2025-10-26T02:54:02.876Z] SECURITY_EVENT | TYPE: DB_CONNECTION_ERROR | IP: SERVER | ROUTE: GLOBAL | MESSAGE: Error conectando a PostgreSQL | DATA: {"error":"connect ECONNREFUSED 127.0.0.1:5432"}
[2025-10-26T03:50:01.569Z] SECURITY_EVENT | TYPE: SQL_INJECTION_WARNING | IP: ::1 | ROUTE: /api/users?id=1' | MESSAGE: Request con warnings de seguridad procesado | DATA: {"warnings":["id: Caracteres peligrosos encontrados: '"],"userInfo":{"ip":"::1","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; es-MX) WindowsPowerShell/5.1.26100.6899","route":"/api/users?id=1'","method":"GET"}}
[2025-10-27T02:15:46.337Z] SECURITY_EVENT | TYPE: SQL_INJECTION_ATTEMPT | IP: ::1 | ROUTE: QUERY_PARAMS.fqqT | MESSAGE: Intento de inyección SQL bloqueado | DATA: {"timestamp":"2025-10-27T02:15:46.336Z","type":"SQL_INJECTION_ATTEMPT","input":"4216 AND 1=1 UNION ALL SELECT 1,NULL,'<script>alert(\"XSS\")</script>',table_name FROM information_schema.tables WHERE 2>1--/**/; EXEC xp_cmdshell('cat ../../../etc/passwd')#","source":"QUERY_PARAMS.fqqT","userInfo":{"ip":"::1","userAgent":"sqlmap/1.9.10.5#dev (https://sqlmap.org)","route":"/api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23","method":"POST"},"severity":"HIGH","blocked":true}
[2025-10-27T02:15:46.341Z] SECURITY_EVENT | TYPE: SQL_INJECTION_WARNING | IP: ::1 | ROUTE: /api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23 | MESSAGE: Request con warnings de seguridad procesado | DATA: {"warnings":["fqqT: Caracteres peligrosos encontrados: ', \", ;, (, ), --, /*, */, <, >, =, _, #"],"userInfo":{"ip":"::1","userAgent":"sqlmap/1.9.10.5#dev (https://sqlmap.org)","route":"/api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23","method":"POST"}}
[2025-10-27T02:15:46.345Z] SECURITY_EVENT | TYPE: SQL_INJECTION_BLOCKED | IP: ::1 | ROUTE: /api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23 | MESSAGE: Request bloqueado por posible inyección SQL | DATA: {"validationResults":[{"source":"QUERY_PARAMS","isValid":false,"sanitized":{"fqqT":"4216 AND 1=1 UNION ALL SELECT 1,NULL,<script>alert(XSS)</script>,table_name FROM information_schema.tables WHERE 2>1--/**/ EXEC xp_cmdshell(cat ../../../etc/passwd)#"},"errors":["fqqT: Patrón SQL peligroso detectado: (\\bUNION\\b|\\bSELECT\\b|\\bINSERT\\b|\\bUPDATE\\b|\\bDELETE\\b|\\bDROP\\b|\\bCREATE\\b|\\bALTER\\b), Patrón SQL peligroso detectado: (--|\\/\\*|\\*\\/|;|\\||&|#), Patrón SQL peligroso detectado: (\\bEXEC\\b|\\bEXECUTE\\b|\\bSP_\\w+\\b|\\bXP_\\w+\\b), Patrón SQL peligroso detectado: (script|javascript|vbscript|onload|onerror|onclick), Patrón SQL peligroso detectado: (\\<|\\>|&lt|&gt|&amp|&#), Patrón SQL peligroso detectado: ([a-z])(\\1+), Caracteres no permitidos en modo estricto: ', \", ;, (, ), --, /*, */, <, >, =, _, #"],"warnings":["fqqT: Caracteres peligrosos encontrados: ', \", ;, (, ), --, /*, */, <, >, =, _, #"]},{"source":"HEADERS","isValid":true,"errors":[],"warnings":[]}],"processingTime":3,"userInfo":{"ip":"::1","userAgent":"sqlmap/1.9.10.5#dev (https://sqlmap.org)","route":"/api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23","method":"POST"}}
[2025-10-27T02:15:46.343Z] SECURITY_EVENT | TYPE: SQL_INJECTION_ATTEMPT | IP: ::1 | ROUTE: QUERY_PARAMS.fqqT | MESSAGE: Intento de inyección SQL bloqueado | DATA: {"timestamp":"2025-10-27T02:15:46.342Z","type":"SQL_INJECTION_ATTEMPT","input":"4216 AND 1=1 UNION ALL SELECT 1,NULL,'<script>alert(\"XSS\")</script>',table_name FROM information_schema.tables WHERE 2>1--/**/; EXEC xp_cmdshell('cat ../../../etc/passwd')#","source":"QUERY_PARAMS.fqqT","userInfo":{"ip":"::1","userAgent":"sqlmap/1.9.10.5#dev (https://sqlmap.org)","route":"/api/auth/login?fqqT=4216%20AND%201%3D1%20UNION%20ALL%20SELECT%201%2CNULL%2C%27%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E%27%2Ctable_name%20FROM%20information_schema.tables%20WHERE%202%3E1--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23","method":"POST"},"severity":"HIGH","blocked":true}
